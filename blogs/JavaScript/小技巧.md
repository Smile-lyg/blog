---
title: 小技巧
date: 2021-06-17
tags:
  - JavaScript
categories:
  - JS基础
---

## 逻辑中断

:::tip

1. 表达式 1 && 表达式 2：若执行表达式 1 为 true 则继续执行表达式 2，否则不执行表达式 2。
2. 表达式 1 || 表达式 2：若执行表达式 1 为 false，则执行表达式 2，否则不执行表达式 2。

:::

```js
let a
a && console.log(1) // 不执行console.log

let b = 2
b && console.log('b') // 执行console.log 打印 b
////////
let a
a || console.log(1) // 执行console.log 打印 1

let b = 2
b || console.log('b') // 不执行console.log
```

## 回调函数

```js
function test(callback) {
  // 如果存在回调函数就立即执行它
  callback && callback()
  console.log(123)
}
test() // 123
test(() => console.log('回调函数被执行了')) // 回调函数被执行了 123
```

## 节流阀

- 使用节流阀控制函数执行次数

```js
let btn = document.createElement('button')
btn.innerHTML = '点我呀'
document.body.appendChild(btn)

// 节流阀
let isDoing = false

async function demo() {
  // 打开节流阀
  isDoing = true
  let a = await new Promise((resolve, reject) => {
    setTimeout(() => resolve(1), 1000)
  })
  // 关闭节流阀
  isDoing = false
  console.log(a)
}

btn.addEventListener('click', function() {
  // 如果异步操作没有结束就不继续执行
  if (isDoing) return
  demo()
})
```

## 使用定时器防抖

```js
let input = document.createElement('input')
document.body.appendChild(input)

let timer = null
// 监听输入框值发生改变事件
input.addEventListener('input', function() {
  // 清除定时器
  clearTimeout(timer)
  // 开启定时器
  timer = setTimeout(() => {
    console.log(input.value)
  }, 1000)
})
```
